<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- 问卷 dao -->
<mapper namespace="dao.NewQuizDao">
    <sql id="quiz_columns">
        `quiz_id`, `class_id`, `user_id`, `course_id`, `date`, `quiz_detail_id`
    </sql>

    <select id="getQuizByUserIdOrCourseId" resultType="entity.Quiz">
        SELECT <include refid="quiz_columns" />
        FROM quiz
        <where>
            <if test="1">
                user_id = #{userId}
            </if>
            <if test="courseId != null"><!-- 如果有 courseId，就加上 -->
                AND course_id = #{courseId}
            </if>
        </where>
    </select>

    <select id="getQuestionsByQuizDetailId" resultType="string">
        SELECT question
        FROM quiz_question
        WHERE quiz_detail_id = #{quizDetailId}
    </select>

    <select id="getAnswersByQuizId" resultType="string">
        SELECT quiz_answer
        FROM quiz_answer
        WHERE quiz_id = #{quizId}
    </select>

    <select id="getQuizByClassIdOrCourseId" resultType="entity.Quiz">
        SELECT <include refid="quiz_columns" />
        FROM quiz
        <where>
            <if test="classId != null">
                class_id = #{classId}
            </if>
            <if test="courseId != null">
                AND course_id = #{courseId}
            </if>
        </where>
    </select>
</mapper>